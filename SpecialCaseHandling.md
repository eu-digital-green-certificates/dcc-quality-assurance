# Handling of Special Cases

This repository contains some QR codes which special cases which needs special handling during the CBOR Decoding/JSON Processing. 


| Description| Occurence| Verifier Action | Issuer Action| QR Code|
|---------|----|----- |----|---|
| Whitespaces in decoded JSON fields| GR/EL QR Vaccination Codes in Field "mp" | During the CBOR Deserialization, all fields MUST be trimmed for whitespaces. | Issuers MUST trim for whitespace before issuing.
| Date of Birth with invalid pattern| BG QR Codes | If the schema is validated during the verifiying, the DOB regex should be ignored. Date/datetime formats should be ignored as well. | The generated QR Code should be deserialized after generation and checked against the schema. | <img src="https://github.com/eu-digital-green-certificates/dcc-quality-assurance/raw/main/BG/1.0.0/specialcases/VAC-NULL-DATETIME.png">
| Dates with invalid Pattern| BG QR Codes in dob field, PL codes in other date fields| Date/datetime formats should be ignored. |  The generated QR Code should be deserialized after generation and checked against the schema. |<img src="https://github.com/eu-digital-green-certificates/dcc-quality-assurance/blob/main/PL/1.0.0/specialcases/VAC-13.png?raw=true">
| t,v,r Entries have null values| BG QR Codes for v/t/r | Schema validation should check for ["null","array"]. "One of" should be ignored. | The generated QR Code should be deserialized after generation and checked against the schema. | <img src="https://github.com/eu-digital-green-certificates/dcc-quality-assurance/blob/main/BG/1.0.0/specialcases/VAC-NULL-DATETIME.png?raw=true">
| Negative doses/Invalid Doses| LV QR Code in Vaccination Certificate (not productive, problem fixed) | Number of doses has in schema a min/max value. Verifiers should remove this limit to accept any kind of doses.| The generated QR Code should be deserialized after generation and checked against the schema.  
| "null/nil/undefined" values in CBOR| Several QR Codes. Problem occurs when the JSON schema is just used to generate Objects which are filled and serialized later without additional schema validation (JSON creation not performed). | All verifiers should add to schema ["null",{DataType}] or remove null/undefined during the cbor deserialization.| All serializers which are used, must be configured/tested to omitting null values to CBOR. A addtional schema validation can avoid this problem.  | <img src="https://github.com/eu-digital-green-certificates/dcc-quality-assurance/blob/main/LV/1.0.0/specialcases/TEST_NULL_values_in_nm_ma.png?raw=true">    
| Standardized Name fields (fnt/gnt) with special signs| Several QR Codes | Verifiers should remove pattern checks. Accept any string.| Issuer must strictly check for pattern after the serialization to CBOR. | <img src="https://github.com/eu-digital-green-certificates/dcc-quality-assurance/blob/b6664861b3bf2a982a6fe9776aa6992a76420e6e/NO/VAC.png?raw=true"/>
| Escaped characters in CBOR content| HU/UA QR Codes | Verifiers should escape " correctly with \\" otherwise the JSON parsing fails. | Issuers should avoid the usage of JSON special signs, because not all CBOR implementations deserialize directly. | <img src="https://github.com/eu-digital-green-certificates/dcc-quality-assurance/blob/main/HU/1.3.0/specialcases/TEST_RAT.png?raw=true">
| QR Code contains Version 1.3 Schema, but field "dr" is empty string and as optional in the Test QR Code | NL Test QR Codes | Verifiers should remove all date format checks from date-time values/dates | Issuer MUST avoid additional fields. Add "additionalFields=false" to the Schema for validation of issued QRs| <img src="https://github.com/eu-digital-green-certificates/dcc-quality-assurance/blob/main/NL/1.3.0/specialcases/TEST_EMPTY_DR_FIELD.png">
|  Interpretation of Validity Dates has a different model. Maximum Lifetime is longer than the validUntil Date. Time Range can be greater than 180 Days. This can lead to an rejection in cause of the 180 days limits for recovery| AT REC Codes | A verifier should check if a holder is in the 180 Day Time Window, instead of checking maximum validity of 180 days. | TBD  |<img src="https://github.com/eu-digital-green-certificates/dcc-quality-assurance/blob/validation3a1/AT/1.0.0/REC.png">
